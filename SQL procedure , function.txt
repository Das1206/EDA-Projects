use test;

CREATE PROCEDURE L9DEMP
AS
BEGIN
		SELECT * FROM EMP 
		WHERE CITY = 'DELHI';
END;

EXECUTE L9DEMP;

EXEC L9DEMP;

L9DEMP;

DROP PROCEDURE L9DEMP;

CREATE PROCEDURE L9DEMP @X AS VARCHAR(20)
AS
BEGIN
		SELECT * FROM EMP 
		WHERE CITY = @X;
END;

L9DEMP 'CHANDIGARH';

CREATE PROCEDURE L9SHOW @T AS VARCHAR(20)
AS
BEGIN
		EXEC('SELECT * FROM ' + @T );
END;

L9SHOW 'STU';

SELECT * FROM EMP;

DELETE FROM EMP WHERE EID=1096;
DELETE FROM EMP_SAL WHERE EID=1096;

DROP PROCEDURE L9INEMP ;

CREATE PROCEDURE L9INEMP @I AS INT, @N AS VARCHAR(30), @A1 AS VARCHAR(30), @A2 AS VARCHAR(30), @C AS VARCHAR(30), @PH AS CHAR(15), @EM AS VARCHAR(50), @DB AS DATE, @DJ AS DATE
AS
BEGIN
		SET NOCOUNT ON;
		INSERT INTO EMP
		VALUES (@I, @N, @A1, @A2, @C, @PH, @EM, @DB, @DJ);
			
		select * FROM EMP WHERE EID = @I;
END;

L9INEMP 1096,'AVINASH GUPTA', 'HNO. 256', 'RAJPUR ROAD', 'DEHRADUN', '98111909890','AG96@GMAIL.COM','10-MAY-1997','14-MAY-2020';

SELECT * FROM EMP_SAL;

CREATE PROCEDURE L9INEMP @I AS INT, @N AS VARCHAR(30), @A1 AS VARCHAR(30), @A2 AS VARCHAR(30), @C AS VARCHAR(30), @PH AS CHAR(15), @EM AS VARCHAR(50), @DB AS DATE, @DJ AS DATE , @DPT AS VARCHAR(30), @DSI AS VARCHAR(30), @S AS INT
AS
BEGIN
		SET NOCOUNT ON;

		INSERT INTO EMP
		VALUES (@I, @N, @A1, @A2, @C, @PH, @EM, @DB, @DJ);
		
		INSERT INTO EMP_SAL
		VALUES(@I, @DPT, @DSI, @S);
			
		select * FROM EMP WHERE EID = @I;
		SELECT * FROM EMP_SAL WHERE EID = @I;

		SELECT EMP.EID, NAME, CITY, DOJ, DEPT , DESI, SALARY AS 'BASIC', SALARY *.09 AS 'PF', SALARY *.15 AS 'HRA'
		FROM EMP
		INNER JOIN EMP_SAL
		ON EMP.EID=EMP_SAL.EID
		WHERE EMP.EID=@I;
END;

L9INEMP 1096,'AVINASH GUPTA', 'HNO. 256', 'RAJPUR ROAD', 'DEHRADUN', '98111909890','AG96@GMAIL.COM','10-MAY-1997','14-MAY-2020', 'TEMP', 'ASSOCIATE',50000;


USE LEARN9;


CREATE TABLE TEMP
(ID INT,
NAME CHAR(5));

INSERT INTO TEMP VALUES (1,'A');
INSERT INTO TEMP VALUES (2,'B');
INSERT INTO TEMP VALUES (3,'C');
INSERT INTO TEMP VALUES (4,'D');
INSERT INTO TEMP VALUES (5,'E');
INSERT INTO TEMP VALUES (6,'F');
INSERT INTO TEMP VALUES (7,'G');
INSERT INTO TEMP VALUES (8,'H');
INSERT INTO TEMP VALUES (9,'I');
INSERT INTO TEMP VALUES (10,'J');

SELECT * FROM TEMP;

DELETE FROM TEMP WHERE ID = 10;

ROLLBACK;

BEGIN TRANSACTION;

DELETE FROM TEMP WHERE ID = 9;
DELETE FROM TEMP WHERE ID = 8;



BEGIN TRANSACTION;

DELETE FROM TEMP WHERE ID = 5;
DELETE FROM TEMP WHERE ID = 6;

SAVE TRANSACTION T1; --SAVE POINTS
DELETE FROM TEMP WHERE ID = 7;

SAVE TRANSACTION T2;
DELETE FROM TEMP WHERE ID = 8;

SAVE TRANSACTION T3;
DELETE FROM TEMP WHERE ID = 9;


BEGIN TRANSACTION ;

DELETE FROM TEMP WHERE ID = 9;

DELETE FROM TEMP WHERE ID = 8;

SELECT * FROM TEMP;

COMMIT;
ROLLBACK;
SELECT * FROM TEMP;

ROLLBACK TRANSACTION T3;
ROLLBACK TRANSACTION T1;
ROLLBACK;

DROP TABLE EMP2;

CREATE TABLE EMP2
(EID INT IDENTITY (100,1), --(START, INCREMENT)
NAME VARCHAR(20),
AGE INT);

INSERT INTO EMP2 (NAME, AGE)
VALUES('AMIT', 25);

INSERT INTO EMP2
VALUES('KAPIL', 27);

INSERT INTO EMP2
VALUES('AJEET', 26);

INSERT INTO EMP2
VALUES ('ROHIT', 28);

INSERT INTO EMP2
VALUES (5,'MOHIT', 28);

DELETE FROM EMP2 WHERE EID = 3;

SELECT * FROM EMP2;

CREATE PROCEDURE INEMP2 @N AS VARCHAR(30), @A AS INT
AS
BEGIN
		INSERT INTO EMP2
		VALUES (@N, @A);

		SELECT * FROM EMP2;
		
END;

INEMP2 'RAMAN', 26;
INEMP2 'RAM', 31;
INEMP2 'KULDEEP', 28;


DROP SEQUENCE MYSEQ;

CREATE SEQUENCE MYSEQ
AS INT
START WITH 1 
INCREMENT BY 1
MAXVALUE 10
MINVALUE 1
CYCLE
CACHE 5;

SELECT NEXT VALUE FOR MYSEQ;

DROP SEQUENCE MYSEQ;
CREATE SEQUENCE MYSEQ
AS INT
START WITH 1 
INCREMENT BY 1;


DROP TABLE EMP3;
CREATE TABLE EMP3
(ID INT,
NAME VARCHAR(20),
AGE INT);

INSERT INTO EMP3
VALUES (NEXT VALUE FOR MYSEQ, 'AJAY', 25);

INSERT INTO EMP3
VALUES (NEXT VALUE FOR MYSEQ, 'KAPIL', 26);

INSERT INTO EMP3
VALUES (NEXT VALUE FOR MYSEQ, 'ROHAN', 24);

INSERT INTO EMP3
VALUES (NEXT VALUE FOR MYSEQ, 'MANDEEP', 26);


SELECT * FROM EMP3;
DROP PROCEDURE INEMP3 ;

CREATE PROCEDURE INEMP3 @N AS VARCHAR(20), @X AS INT
AS
BEGIN
		INSERT INTO EMP3
		VALUES(NEXT VALUE FOR MYSEQ, @N , @X);

		SELECT * FROM EMP3;
END;

INEMP3 'RAVINDER', 31;
INEMP3 'MUKESH', 29;

CREATE TABLE EMP3
(ID CHAR(5),
NAME VARCHAR(20),
AGE INT);


CREATE PROCEDURE INEMP3 @N AS VARCHAR(20), @X AS INT
AS
BEGIN
		DECLARE @I AS INT;
		DECLARE @ID AS CHAR(5);
		SET @I = (NEXT VALUE FOR MYSEQ);
		
		IF @I < 10
			SET @ID = CONCAT('E000', @I);
		ELSE IF @I < 100
			SET @ID = CONCAT('E00', @I);
		ELSE IF @I < 1000
			SET @ID = CONCAT('E0', @I);	
		ELSE IF @I < 10000
			SET @ID = CONCAT('E', @I);


		INSERT INTO EMP3
		VALUES(@ID, @N , @X);

		SELECT * FROM EMP3;
END;
INEMP3 'RAM', 35;
INEMP3 'KABEER', 27;
